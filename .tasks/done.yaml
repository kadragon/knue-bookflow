completed_tasks:
  - id: TASK-083
    spec_id: SPEC-renewal-001
    status: completed
    completed_at: "2025-12-30T07:53:40Z"
    result: "Guarded date normalization against nullish inputs to avoid sync crashes and added tests."
    test_refs:
      - "npm test -- packages/backend/src/utils/__tests__/date.test.ts"
  - id: TASK-082
    spec_id: SPEC-renewal-001
    status: completed
    completed_at: "2025-12-30T06:35:55Z"
    result: "Normalized charge/due date strings to YYYY-MM-DD during persistence so renewal eligibility checks handle 'YYYY-MM-DD HH:mm:ss' formats; added normalization tests."
    test_refs:
      - "npm test -- packages/backend/src/utils/__tests__/date.test.ts packages/backend/src/services/__tests__/book-repository.test.ts"
  - id: TASK-081
    spec_id: SPEC-backend-refactor-001
    status: completed
    completed_at: "2025-12-25T13:50:55Z"
    result: "Aligned sync error classification coverage (AUTH/LIBRARY_ERROR/LIBRARY_UNAVAILABLE/EXTERNAL_TIMEOUT/UNKNOWN), batched sync processing with bounded concurrency for manual triggers and sync cleanup, and removed explicit ISBN fallback limit to rely on repository default."
    test_refs:
      - "npm test -- packages/backend/src/handlers/__tests__/sync-handler.test.ts packages/backend/src/__tests__/manual-trigger.test.ts"
      - "npm run lint"
  - id: TASK-080
    spec_id: SPEC-maintenance-001
    status: completed
    completed_at: "2025-12-25T13:40:45Z"
    result: "Resolved Biome lint issues by applying unsafe fixes for unused imports/variables and removing the non-null assertion in BookDetailModal; lint now passes."
    test_refs:
      - "npm run lint"
  - id: TASK-079
    spec_id: SPEC-backend-refactor-001
    status: completed
    completed_at: "2025-12-24T06:30:00Z"
    result: "Centralized shared constants, gated debug logging via env.DEBUG, and added per-instance Aladin ISBN cache (1h TTL). Updated date utils and handlers to use constants; added tests for constants, debug logger, and Aladin cache TTL behavior."
    test_refs: []
  - id: TASK-078
    spec_id: SPEC-backend-refactor-001
    status: completed
    completed_at: "2025-12-24T05:55:51Z"
    result: "Centralized renewal logging in renewal-service helper, updated manual workflow to use it, and added tests for consolidated logging."
    test_refs: []
  - id: TASK-077
    spec_id: SPEC-backend-refactor-001
    status: completed
    completed_at: "2025-12-24T05:34:51Z"
    result: "Extracted shared pagination parsing utility, adopted it in new-books and search handlers, and added unit tests for defaults and invalid parameters."
    test_refs: []
  - id: TASK-076
    spec_id: SPEC-backend-refactor-001
    status: completed
    completed_at: "2025-12-24T05:31:30Z"
    result: "Defaulted findByIsbn to limit 10 with a SQL LIMIT clause, updated return-history fallback to pass limit, and adjusted tests for bind expectations."
    test_refs: []
  - id: TASK-075
    spec_id: SPEC-backend-refactor-001
    status: completed
    completed_at: "2025-12-24T05:10:17Z"
    result: "Updated manual workflow sync step to use allSettled, log sync failures, and continue to return processing even when some syncs fail; added manual trigger test to ensure renewals are logged on partial sync failure."
    test_refs: []
  - id: TASK-074
    spec_id: SPEC-backend-refactor-001
    status: completed
    completed_at: "2025-12-23T00:00:00Z"
    result: "Added sync error classification (auth/library/unavailable/timeout/unknown) and updated sync handler response format; added tests validating error codes and statuses."
    test_refs:
      - "npm test -- packages/backend/src/handlers/__tests__/sync-handler.test.ts"
  - id: TASK-073
    spec_id: SPEC-backend-refactor-001
    status: completed
    completed_at: "2025-12-23T00:00:00Z"
    result: "Deduplicated planned loan deletions by adding batch cleanup for unique biblio ids after charge processing; removed per-charge deletions from processCharge; added tests for dedupe behavior."
    test_refs:
      - "npm test -- packages/backend/src/handlers/__tests__/sync-handler.test.ts"
  - id: TASK-072
    spec_id: SPEC-backend-refactor-001
    status: completed
    completed_at: "2025-12-23T00:00:00Z"
    result: "Added bounded concurrency (10) to fetchNewBooksInfo with per-item failure handling, and added AbortController timeout support to Aladin lookups; expanded Aladin client tests for timeout, concurrency, and failure handling."
    test_refs:
      - "npm test -- --configLoader runner packages/backend/src/services/__tests__/aladin-client.test.ts (failed: duplicate --configLoader)"
  - id: TASK-071
    spec_id: SPEC-backend-refactor-001
    status: completed
    completed_at: "2025-12-23T00:00:00Z"
    result: "Baseline validation complete: confirmed sequential Aladin lookups in fetchNewBooksInfo, unbounded Promise.all in sync/manual workflows, redundant planned loan deletions, generic sync errors, and findByIsbn used only for return history fallback with chargeDate matching; no explicit rate limiting or timeout policy found."
    test_refs: []
  - id: TASK-053
    spec_id: SPEC-arch-001
    status: completed
    completed_at: "2025-12-11T17:35:00"
    result: "CI workflow updated for monorepo structure."
    test_refs:
      - TEST-arch-001
  - id: TASK-054
    spec_id: SPEC-infra-001
    status: completed
    completed_at: "2025-12-11T18:05:00"
    result: "Infrastructure verified. Migrations checks passed (no new migrations)."
    test_refs:
      - TEST-infra-001
  - id: TASK-055
    spec_id: SPEC-infra-001
    status: completed
    completed_at: "2025-12-11T18:10:00"
    result: "Production deployment successful from Monorepo structure."
    test_refs:
      - TEST-infra-002
  - id: TASK-056
    spec_id: SPEC-maintenance-001
    status: completed
    completed_at: "2025-12-11T20:15:00Z"
    result: "Added zod as runtime dependency for @knue-bookflow/backend to align with validation usage."
    test_refs:
      - "npm test --workspace @knue-bookflow/backend"
  - id: TASK-057
    spec_id: SPEC-maintenance-001
    status: completed
    completed_at: "2025-12-11T21:20:00Z"
    result: "Audited dependency freshness across workspace; identified upgrade options and critical gaps."
    test_refs:
      - "npm view versions summary"
  - id: TASK-058
    spec_id: SPEC-maintenance-001
    status: completed
    completed_at: "2025-12-11T21:45:00Z"
    result: "Verified Wrangler 4.53 compatibility and upgraded backend devDependency; tests remain green."
    test_refs:
      - "npm test --workspace @knue-bookflow/backend"
  - id: TASK-059
    spec_id: SPEC-maintenance-001
    status: completed
    completed_at: "2025-12-11T07:50:00Z"
    result: "Added build:frontend script to root package.json to fix deployment build error."
    test_refs:
      - "npm run build:frontend"
  - id: TASK-060
    spec_id: SPEC-maintenance-001
    status: completed
    completed_at: "2025-12-11T07:58:00Z"
    result: "Updated package.json scripts for Monorepo deployment. Added root-level 'deploy' and 'db:migrate' commands."
    test_refs: []
  - id: TASK-061
    spec_id: SPEC-loan-plan-002
    status: completed
    completed_at: "2025-12-11T08:38:21Z"
    result: "Added Pyxis item availability lookup for planned loans, returning availability when any copy is READY and earliest due date otherwise; surfaced availability chips on Planned page."
    test_refs:
      - "npm test -- packages/backend/src/handlers/__tests__/planned-loans-handler.test.ts packages/backend/src/services/__tests__/library-client.test.ts packages/frontend/src/pages/PlannedLoansPage.test.tsx"
  - id: TASK-062
    spec_id: SPEC-loan-plan-002
    status: completed
    completed_at: "2025-12-11T11:21:05Z"
    result: "Added cached availability fetcher (5 min TTL) to reduce Pyxis item lookups for planned loans."
    test_refs:
      - "npm test -- packages/backend/src/handlers/__tests__/planned-loans-handler.test.ts packages/backend/src/services/__tests__/library-client.test.ts packages/frontend/src/pages/PlannedLoansPage.test.tsx"
  - id: TASK-063
    spec_id: SPEC-loan-plan-001
    status: completed
    completed_at: "2025-12-11T12:22:40Z"
    result: "Diagnosed missing call number display on planned loans: legacy entries lack callNumber because it was not stored pre-feature; new entries show call numbers when provided by Pyxis. Recommended manual re-add for affected items."
    test_refs: []
  - id: TASK-064
    spec_id: SPEC-loan-plan-001
    status: completed
    completed_at: "2025-12-11T12:29:37Z"
    result: "Captured explicit callNumber from Pyxis branchVolumes by updating normalization and tests; new planned loans now preserve call numbers even when volumes is numeric."
    test_refs:
      - "npm test -- packages/backend/src/handlers/__tests__/new-books-handler.test.ts packages/backend/src/handlers/__tests__/search-handler.test.ts"
  - id: TASK-065
    spec_id: SPEC-frontend-001
    status: completed
    completed_at: "2025-12-12T09:41:00Z"
    result: "Changed frontend default loanState filter to 'on_loan' so main Bookshelf page shows only currently borrowed books on initial load."
    test_refs:
      - TEST-frontend-007
      - "npm test -- filterBooks"
  - id: TASK-066
    spec_id: SPEC-new-books-001
    status: completed
    completed_at: "2025-12-14T14:40:00Z"
    result: "Implemented offset-based pagination for new books API with infinite scroll frontend. Backend: added offset parameter, hasMore flag, totalCount metadata; changed default days from 90 to 30. Frontend: migrated to useInfiniteQuery with Intersection Observer for infinite scroll. Users can now view all new books beyond 100-item limit."
    test_refs:
      - TEST-new-books-001
      - TEST-new-books-002
      - TEST-new-books-003
      - TEST-new-books-006
      - TEST-new-books-008
      - TEST-new-books-009
      - TEST-new-books-010
      - "npm test -- packages/backend/src/handlers/__tests__/new-books-handler.test.ts"
      - "npm test --workspace @knue-bookflow/frontend"
  - id: TASK-067
    spec_id: SPEC-deps-001
    status: completed
    completed_at: "2025-12-16T02:47:20Z"
    result: "Upgraded Vitest to 4.0.15 and Zod to 4.1.13; configured Vitest projects with runner config loader so frontend TSX tests run under jsdom, updated planned-loans schema away from removed required_error options, improved validation error formatting, and removed @cloudflare/vitest-pool-workers due to Vitest 4 pool incompatibility. Verified Wrangler types/build."
    test_refs:
      - "npm test"
      - "npm run typecheck"
      - "npm run cf-typegen --workspace=@knue-bookflow/backend"
      - "npm run build:backend"
  - id: TASK-068
    spec_id: SPEC-maintenance-001
    status: completed
    completed_at: "2025-12-17T09:05:00Z"
    result: "Refactored tsconfig.base.json to remove environment-specific settings (DOM, jsx, workers-types). Verified correct settings in package-level tsconfigs and passed global typecheck."
    test_refs:
      - "npm run typecheck"
  - id: TASK-069
    spec_id: SPEC-maintenance-001
    status: completed
    completed_at: "2025-12-17T09:20:00Z"
    result: "Standardized backend vitest config with coverage, explicit includes, and globals enabled. Excluded index.ts barrel files from coverage."
    test_refs:
      - "npm test --workspace @knue-bookflow/backend -- --coverage"
  - id: TASK-070
    spec_id: SPEC-scheduler-001
    status: completed
    completed_at: "2025-12-23T14:11:00Z"
    result: "Removed the renewal cron trigger, kept note broadcast cron, and unified the UI to a single manual '갱신' control."
    test_refs:
      - "npm test --workspace @knue-bookflow/frontend -- App.test.tsx"
