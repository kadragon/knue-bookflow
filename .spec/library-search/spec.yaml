spec_id: SPEC-search-001
title: "Library Book Search API"
description: |
  API endpoint for searching books in KNUE library catalog.
  Supports title, author, ISBN search with pagination.
  Transforms library API response to frontend-friendly format.

given_when_then:
  - given: "Valid search query with pagination parameters"
    when: "GET /api/search is called"
    then: "Returns search results with metadata"

  - given: "Empty or missing query parameter"
    when: "GET /api/search is called"
    then: "Returns 400 error"

  - given: "Invalid pagination parameters (max > 100 or offset < 0)"
    when: "GET /api/search is called"
    then: "Returns 400 error with validation message"

  - given: "Library API fails or times out"
    when: "Search is attempted"
    then: "Returns 500 error with error message"

  - given: "Search result with publication field"
    when: "parsePublication is called"
    then: "Correctly extracts publisher and year, handling edge cases"

acceptance_tests:
  - id: TEST-search-001
    desc: "Valid search returns transformed results with correct metadata"

  - id: TEST-search-002
    desc: "Missing query parameter returns 400 error"

  - id: TEST-search-003
    desc: "Invalid max parameter (0, 101, NaN) returns 400 error"

  - id: TEST-search-004
    desc: "Invalid offset parameter (-1, NaN) returns 400 error"

  - id: TEST-search-005
    desc: "Library API error returns 500 with error message"

  - id: TEST-search-006
    desc: "parsePublication handles various formats (with/without year, commas in publisher)"

dependencies:
  - governance: "coding-style"
  - service: "LibraryClient.searchBooks"

linked_tasks:
  - TASK-041
